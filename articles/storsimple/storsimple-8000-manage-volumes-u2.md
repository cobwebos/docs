---
title: "管理 StorSimple 卷 (Update 3) | Microsoft Docs"
description: "介绍了如何添加、修改、监视和删除 StorSimple 卷，以及在必要时如何使其脱机。"
services: storsimple
documentationcenter: NA
author: alkohli
manager: jeconnoc
editor: 
ms.assetid: 
ms.service: storsimple
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 12/08/2017
ms.author: alkohli
ms.openlocfilehash: c9c575f42e6c8730b9404c62fb60e710d9d3bc80
ms.sourcegitcommit: 094061b19b0a707eace42ae47f39d7a666364d58
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/08/2017
---
# <a name="use-the-storsimple-device-manager-service-to-manage-volumes-update-3-or-later"></a>使用 StorSimple 设备管理器服务管理卷（Update 3 或更高版本）

## <a name="overview"></a>概述

本教程介绍如何使用 StorSimple 设备管理器服务在运行 Update 3 和更高版本的 StorSimple 8000 系列设备上创建和管理卷。

StorSimple Device Manager 服务是 Azure 门户中的一个扩展，可让用户通过单个 Web 界面管理 StorSimple 解决方案。 使用 Azure 门户管理所有设备上的卷。 还可以创建和管理 StorSimple 服务、管理设备、备份策略和备份目录，以及查看警报。

## <a name="volume-types"></a>卷类型

StorSimple 卷可以是：

* **本地固定卷**：这些卷中的数据随时保留在本地 StorSimple 设备中。
* **分层卷**：这些卷中的数据可溢出到云中。

存档卷就是一种分层卷。 存档卷使用的可删除重复数据的大型区块可让设备将较大的数据段传输到云中。

如果需要，可以将卷类型从本地卷更改为分层卷，或者从分层卷更改为本地卷。 有关详细信息，请转到[更改卷类型](#change-the-volume-type)。

### <a name="locally-pinned-volumes"></a>本地固定卷

本地固定卷是完整预配的卷，它们不会在云中将数据分层，因此可为主要数据提供本地保证，不受云连接的影响。 本地固定卷中的数据不会进行重复数据删除和压缩，但是，本地固定卷的快照将进行重复数据删除。 

本地固定卷是完整预配的卷，因此，创建这种卷时，设备上必须有足够的空间。 可以在 StorSimple 8100 设备上预配大小高达 8 TB 的本地固定卷，在 8600 设备上预配大小高达 20 TB 的本地固定卷。 StorSimple 将设备上的剩余本地空间保留用于快照、元数据和数据处理。 可以将本地固定卷大小增加到可用的最大空间，但创建卷之后无法减少卷的大小。

创建本地固定卷后，可用于创建分层卷的空间会减少。 反之亦然：如果已有分层卷，可用于创建本地固定卷的空间将低于上述最大限制。 有关本地卷的详细信息，请参阅 [frequently asked questions on locally pinned volumes](storsimple-8000-local-volume-faq.md)（本地固定卷的常见问题）。

### <a name="tiered-volumes"></a>分层卷

分层卷是精简预配的卷，其中经常访问的数据保留在设备本地，较少使用的数据自动分层到云中。 精简设置是一项虚拟化技术，可使可用存储看起来超过物理资源。 StorSimple 使用精简设置分配恰好满足当前需求的足够空间，而不是提前保留充足的存储。 云存储的弹性性质促进了这一方法的实施，因为 StorSimple 能够增加或减少云存储以满足不断变化的需求。

如果针对存档数据使用分层卷，请选中“将此卷用于不常访问的存档数据”复选框将卷的重复数据删除区块大小更改为 512 KB。 如果不选择此选项，相应的分层卷将使用 64 KB 区块大小。 重复数据删除区块越大，设备将大型存档数据传输到云端的速度就越快。


### <a name="provisioned-capacity"></a>预配的容量

参阅下表了解每种设备与卷类型的最大预配容量。 （请注意，本地固定卷无法在虚拟设备上使用。）

|  | 分层卷大小上限 | 本地固定卷大小上限 |
| --- | --- | --- |
| **物理设备** | | |
| 8100 |64 TB |8 TB |
| 8600 |64 TB |20 TB |
| **虚拟设备** | | |
| 8010 |30 TB |不适用 |
| 8020 |64 TB |不适用 |

## <a name="the-volumes-blade"></a>“卷”边栏选项卡

在“卷”边栏选项卡中，可以管理在 Microsoft Azure StorSimple 设备上为发起程序（服务器）预配的存储卷。 该边栏选项卡显示已连接到服务的 StorSimple 设备上的卷列表。

 ![“卷”页](./media/storsimple-8000-manage-volumes-u2/volumeslist.png)

卷包括一系列属性：

* **卷名称** – 必须保持唯一且有助于识别卷的描述性名称。 筛选特定的卷时，还可以使用此名称来监视报告。 创建卷后，无法将其重命名。
* **状态** – 可以是“联机”或“脱机”。 如果某个卷已脱机，允许访问该卷的发起程序（服务器）将看不到该卷。
* **容量** – 指定发起程序（服务器）可以存储的数据总量。 本地固定卷是完整预配的卷，位于 StorSimple 设备上。 分层卷是精简预配的卷，可删除重复数据。 使用精简预配的卷时，设备不会根据配置的卷容量在内部或者在云中预先分配物理存储容量。 卷容量是按需要分配和使用的。
* **类型** – 指示卷是**分层**卷（默认设置）还是**本地固定**卷。

使用本教程中的说明执行以下任务：

* 添加卷 
* 修改卷 
* 更改卷类型
* 删除卷 
* 使卷脱机 
* 监视卷 

## <a name="add-a-volume"></a>添加卷

在部署 StorSimple 8000 系列设备期间[创建了一个卷](storsimple-8000-deployment-walkthrough-u2.md#step-6-create-a-volume)。 添加卷的过程与此类似。

#### <a name="to-add-a-volume"></a>添加卷

1. 从“设备”边栏选项卡中的设备列表中，选择设备。 单击“+ 添加卷”。

    ![添加新版本](./media/storsimple-8000-manage-volumes-u2/step5createvol1.png)

2. 在“添加卷”边栏选项卡中：
   
    1. “选择设备”字段中会自动填充你当前的设备。

    2. 从下拉列表中，选择要在其中添加卷的卷容器。

    3.  键入卷的“名称”  。 创建卷后，无法重命名卷。

    4. 在下拉列表中，选择卷的“类型”。 对于需要本地保证、低延迟和高性能的工作负荷，请选择“本地固定”  卷。 对于所有其他数据，请选择“分层”  卷。 如果将此卷用于存档数据，请选中“将此卷用于不常访问的存档数据”。
      
       分层卷精简预配，可快速创建。 为用于存档数据的分层卷选中“将此卷用于不常访问的存档数据”，会将卷的重复数据删除区块大小更改为 512 KB。 如果未选中此字段，则相应的分层卷使用的区块大小为 64 KB。 重复数据删除区块越大，设备将大型存档数据传输到云端的速度就越快。
       
       本地固定卷充分预配，可确保卷上的主数据保留在设备本地，未溢出到云端。  如果创建一个本地固定卷，设备会检查本地层上的可用空间，预配所请求大小的卷。 创建本地固定卷的过程中，设备中的现有数据可能会溢出到云端，因此创建该卷所花的时间可能会很长。 总时间取决于预配卷的大小、可用的网络带宽以及设备中的数据。

    5. 指定卷的“预配容量”  。 根据选择的卷类型，记下可用的容量。 指定的卷大小不得超过可用空间。
      
       可以在 8100 设备上预配高达 8.5 TB 的本地固定卷，预配高达 200 TB 的分层卷。 8600 设备更大，可以预配高达 22.5 TB 的本地固定卷，预配高达 500 TB 的固定卷。 由于托管分层卷的工作集需要使用设备上的本地空间，创建本地固定卷自然会影响用于预配分层卷可用的空间。 因此，如果创建了本地固定卷，则可用于创建分层卷的空间就会减少。 同样，如果创建分层卷，用于创建本地固定卷的可用空间也会减少。
      
       如果在 8100 设备预配 8.5 TB（允许的最大大小）的本地固定卷，则已用尽设备上的所有可用本地空间。 由于设备上没有本地空间可用于托管分层卷的工作集，因此从这一刻起无法再创建任何分层卷。 现有分层卷也会影响可用的空间。 例如，如果 8100 设备上的分层卷已占用大约 106 TB 的空间，那么本地固定卷只有 4 TB 的空间可用。

    6. 在“连接的主机”字段中，单击箭头。 在“连接的主机”边栏选项卡中，选择现有的 ACR 或添加新的 ACR。 如果选择新 ACR，请提供 ACR 的**名称**，提供 Windows 主机的 **iSCSI 限定名称** (IQN)。 如果没有 IQN，请转到 [获取 Windows Server 主机的 IQN](#get-the-iqn-of-a-windows-server-host)。 单击“创建” 。 使用指定的设置创建卷。

        ![单击创建](./media/storsimple-8000-manage-volumes-u2/step5createvol3.png)

新卷现在已可供使用。

> [!NOTE]
> 如果创建了一个本地固定卷，随即又创建另一个本地固定卷，卷创建作业将按顺序运行。 必须先完成第一个卷创建作业，才能开始下一个卷创建作业。

## <a name="modify-a-volume"></a>修改卷

需要扩展卷或更改有权访问该卷的主机时，可以修改卷。

> [!IMPORTANT]
> * 如果在设备上修改了卷大小，则还必须在主机上修改卷大小。
> * 此处所述的主机端步骤适用于 Windows Server 2012 (2012R2)。 Linux 或其他主机操作系统的过程有所不同。 如果要在运行其他操作系统的主机上修改卷，请参考主机操作系统的说明。

#### <a name="to-modify-a-volume"></a>修改卷

1. 转到 StorSimple Device Manager 服务，并单击“设备”。 从设备的表格列表中，选择包含所要修改的卷的设备。 单击“设置”>“卷”。

    ![转到“卷”边栏选项卡](./media/storsimple-8000-manage-volumes-u2/modifyvol2.png)

2. 从卷的表格列表中选择该卷，单击右键调用上下文菜单。 选择“脱机”，使要修改的卷脱机。

    ![选择卷并使卷脱机](./media/storsimple-8000-manage-volumes-u2/modifyvol4.png)

3. 在“脱机”边栏选项卡中，查看使卷脱机所造成的影响，选择相应的复选框。 确保先将主机上的相应卷脱机。 有关如何在连接到 StorSimple 的主机服务器上使卷脱机的信息，请参阅特定于操作系统的说明。 单击“脱机”。

    ![查看使卷脱机所造成的影响](./media/storsimple-8000-manage-volumes-u2/modifyvol5.png)

4. 使卷脱机后（根据卷状态判断），请选择该卷，单击右键调用上下文菜单。 选择“修改卷”。

    ![选择“修改卷”](./media/storsimple-8000-manage-volumes-u2/modifyvol9.png)


5. 在“修改卷”边栏选项卡中，可以进行以下更改：
   
   1. 无法编辑卷的**名称**。
   2. 将“类型”从“本地固定”转换为“分层”，或者从“分层”转换为“本地固定”（有关详细信息，请参阅[更改卷类型](#change-the-volume-type)）。
   3. 增加**预配的容量**。 **预配的容量**只能增加。 创建卷后无法缩小卷。
   4. 在“连接的主机”下面，可以修改 ACR。 若要修改 ACR，卷必须处于脱机状态。

       ![查看使卷脱机所造成的影响](./media/storsimple-8000-manage-volumes-u2/modifyvol11.png)

5. 单击“保存”以保存更改。 出现确认提示时，单击“是”。 Azure 门户会显示更新卷消息。 成功更新卷后，它会显示一条成功消息。

    ![查看使卷脱机所造成的影响](./media/storsimple-8000-manage-volumes-u2/modifyvol5.png)

7. 如果要扩展卷，请在 Windows 主机计算机上完成以下步骤：
   
   1. 转到“计算机管理” ->“磁盘管理”。
   2. 右键单击“磁盘管理”，并选择“重新扫描磁盘”。
   3. 在磁盘列表中选择已更新的卷，单击右键，并选择“扩展卷”。 此时会启动“扩展卷向导”。 单击“下一步”。
   4. 使用默认值完成向导。 完成向导后，卷应该显示增加的大小。
      
      > [!NOTE]
      > 如果扩展了一个本地固定卷，随即又扩展另一个本地固定卷，卷扩展作业将按顺序运行。 必须先完成第一个卷扩展作业，才能开始下一个卷扩展作业。
      

## <a name="change-the-volume-type"></a>更改卷类型

可以将卷类型从“分层”更改为“本地固定”或者从“本地固定”更改为“分层”。 但是，不应该经常进行这种转换。

### <a name="tiered-to-local-volume-conversion-considerations"></a>将分层卷更改为本地卷的注意事项

将卷从“分层”转换为“本地固定”的部分原因包括：

* 关于数据可用性和性能的本地保证
* 消除云延迟和云连接问题。

通常，这些卷是经常要访问的现有小型卷。 创建的本地固定卷经过完整预配。 

如果要将分层卷转换为本地固定卷，StorSimple 会先验证设备上是否有足够的空间，然后开始转换。 如果空间不足，会显示错误，并取消该操作。 

> [!NOTE]
> 在开始从“分层”转换为“本地固定”之前，请务必考虑其他工作负荷的空间要求。 

从分层卷转换为本地固定卷可能对设备性能造成负面影响。 此外，以下因素可能会增加完成转换所需的时间：

* 带宽不足。
* 没有最新备份。

要将这些因素可能造成的影响降到最低：

* 查看带宽限制策略，确保提供 40 Mbps 专用带宽。
* 将转换安排在非高峰时间。
* 开始转换之前先创建云快照。

如果要转换多个卷（支持不同的工作负荷），应该指定卷转换的优先级，先转换高优先级的卷。 例如，应该先转换托管虚拟机 (VM) 的卷或者具有 SQL 工作负荷的卷，然后才转换文件共享工作负荷的卷。

### <a name="local-to-tiered-volume-conversion-considerations"></a>将本地卷更改为分层卷的注意事项

如果需要额外的空间来预配其他卷，可以将本地固定卷更改为分层卷。 将本地固定卷转换为分层卷时，设备上的可用容量会根据释放的容量大小增加。 如果连接问题导致无法将卷从本地类型转换为分层类型，本地卷将展示分层卷的属性，直到完成转换为止。 这是因为，可能有一部分数据溢出到云中。 这些溢出的数据继续占用设备上的本地空间，在重启并完成操作之前无法释放。

> [!NOTE]
> 转换卷的过程可能需要一段时间，开始转换之后无法取消转换。 卷在转换期间仍保持联机。可以创建备份，但是转换正在进行时无法扩展或还原卷。


#### <a name="to-change-the-volume-type"></a>更改卷类型

1. 转到 StorSimple Device Manager 服务，并单击“设备”。 从设备的表格列表中，选择包含所要修改的卷的设备。 单击“设置”>“卷”。

    ![转到“卷”边栏选项卡](./media/storsimple-8000-manage-volumes-u2/modifyvol2.png)

3. 从卷的表格列表中选择该卷，单击右键调用上下文菜单。 选择“修改”。

    ![从上下文菜单中选择“修改”](./media/storsimple-8000-manage-volumes-u2/changevoltype2.png)

4. 在“修改卷”边栏选项卡上，从“类型”下拉列表中选择新类型，以更改卷类型。
   
   * 如果将类型更改为“本地固定”，StorSimple 会检查是否有足够的容量。
   * 如果将类型更改为“分层”，且此卷用于存档数据，请选中“将此卷用于不常访问的存档数据”复选框。
   * 将本地固定卷配置为分层卷时（反之亦然），会显示以下消息。
   
    ![更改卷类型消息](./media/storsimple-8000-manage-volumes-u2/changevoltype3.png)

7. 单击“保存”以保存更改。 系统提示确认时，请单击“是”开始转换过程。 

    ![保存并确认](./media/storsimple-8000-manage-volumes-u2/modifyvol11.png)

8. Azure 门户会显示创建作业的通知，指出这会更新卷。 单击该通知可监视卷转换作业的状态。

    ![卷转换作业](./media/storsimple-8000-manage-volumes-u2/changevoltype5.png)

## <a name="take-a-volume-offline"></a>使卷脱机

想要修改或删除某个卷时，可能需要使卷脱机。 脱机的卷不可用于读写访问。 必须在主机和设备上使卷脱机。

#### <a name="to-take-a-volume-offline"></a>使卷脱机

1. 使卷脱机之前，请确保相关的卷未被使用。
2. 先在主机上使卷脱机。 这样可以消除任何造成卷上数据损坏的潜在风险。 有关具体的步骤，请参阅适用于主机操作系统的说明。
3. 在主机上脱机后，执行以下步骤在设备上使卷脱机：
   
    1. 转到 StorSimple Device Manager 服务，并单击“设备”。 从设备的表格列表中，选择包含所要修改的卷的设备。 单击“设置”>“卷”。

        ![转到“卷”边栏选项卡](./media/storsimple-8000-manage-volumes-u2/modifyvol2.png)

    2. 从卷的表格列表中选择该卷，单击右键调用上下文菜单。 选择“脱机”，使要修改的卷脱机。

        ![选择卷并使卷脱机](./media/storsimple-8000-manage-volumes-u2/modifyvol4.png)

3. 在“脱机”边栏选项卡中，查看使卷脱机所造成的影响，选择相应的复选框。 单击“脱机”。 

    ![查看使卷脱机所造成的影响](./media/storsimple-8000-manage-volumes-u2/modifyvol5.png)
      
      卷脱机后，系统会发出通知。 卷的状态也会更新为“脱机”。
      
4. 卷脱机后，如果选择该卷并单击右键，上下文菜单中的“联机”选项将会激活。

> [!NOTE]
> “脱机”命令向设备发送请求来使卷脱机。 如果主机仍在使用该卷，则会导致连接断开，但是使卷脱机的命令不会失败。

## <a name="delete-a-volume"></a>删除卷

> [!IMPORTANT]
> 仅当卷已脱机时，才可以删除该卷。

若要删除卷，请完成以下步骤。

#### <a name="to-delete-a-volume"></a>删除卷

1. 转到 StorSimple Device Manager 服务，并单击“设备”。 从设备的表格列表中，选择包含所要修改的卷的设备。 单击“设置”>“卷”。

    ![转到“卷”边栏选项卡](./media/storsimple-8000-manage-volumes-u2/modifyvol2.png)

3. 检查要删除的卷的状态。 如果要删除的卷不处于脱机状态，请先使其脱机。 请按照[使卷脱机](#take-a-volume-offline)中的步骤操作。
4. 卷脱机后，请选择该卷，单击右键调用上下文菜单，选择“删除”。

    ![从上下文菜单中选择“删除”](./media/storsimple-8000-manage-volumes-u2/deletevol1.png)

5. 在“删除”边栏选项卡中，请查看信息，选中删除卷所造成的影响对应的复选框。 删除某个卷时，该卷中的所有数据都会丢失。 

    ![保存并确认更改](./media/storsimple-8000-manage-volumes-u2/deletevol2.png)

6. 删除卷后，卷的表格列表会更新以指示该卷被删除。

    ![更新的卷列表](./media/storsimple-8000-manage-volumes-u2/deletevol3.png)
   
   > [!NOTE]
   > 如果删除本地固定卷，可能不会立即更新新卷的可用空间。 StorSimple 设备管理器服务会定期更新本地可用空间。 建议等待几分钟后再尝试创建新卷。
   >
   > 此外，如果删除了一个本地固定卷，随即又删除另一个本地固定卷，卷删除作业将按顺序运行。 必须先完成第一个卷删除作业，才能开始下一个卷删除作业。

## <a name="monitor-a-volume"></a>监视卷

使用卷监视功能可以收集卷的 I/O 相关统计信息。 默认情况下，创建的前 32 个卷会启用监视， 其他卷会禁用监视。 

> [!NOTE]
> 对于克隆的卷，默认情况下禁用监视。


可以执行以下步骤来为卷启用或禁用监视。

#### <a name="to-enable-or-disable-volume-monitoring"></a>启用或禁用卷监视

1. 转到 StorSimple Device Manager 服务，并单击“设备”。 从设备的表格列表中，选择包含所要修改的卷的设备。 单击“设置”>“卷”。
2. 从卷的表格列表中选择该卷，单击右键调用上下文菜单。 选择“修改”。
3. 在“修改卷”边栏选项卡中，为“监视”选择“启用”或“禁用”，以启用或禁用监视。

    ![禁用监视](./media/storsimple-8000-manage-volumes-u2/monitorvol1.png) 

4. 单击“保存”，出现确认提示时，单击“是”。 Azure 门户会显示正在更新卷的通知；成功更新卷后，会显示成功消息。

## <a name="next-steps"></a>后续步骤

* 了解如何[克隆 StorSimple 卷](storsimple-8000-clone-volume-u2.md)。
* 了解如何[使用 StorSimple 设备管理器服务管理 StorSimple 设备](storsimple-8000-manager-service-administration.md)。

