---
title: 在 Azure IoT Central 应用程序中设置设备模板 | Microsoft Docs
description: 了解如何使用度量、设置、属性、规则和仪表板设置设备模板。
author: sarahhubbard
ms.author: sahubbar
ms.date: 07/23/2019
ms.topic: conceptual
ms.service: iot-central
services: iot-central
manager: peterpr
ms.openlocfilehash: e3925f2d6c2a1034cc96475721de7936deeb4a9d
ms.sourcegitcommit: cf36df8406d94c7b7b78a3aabc8c0b163226e1bc
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/09/2019
ms.locfileid: "73895626"
---
# <a name="set-up-and-manage-a-device-template-preview-features"></a>设置和管理设备模板（预览功能）

[!INCLUDE [iot-central-pnp-original](../../../includes/iot-central-pnp-original-note.md)]

设备模板是一个蓝图，用于定义可连接到 Azure IoT Central 应用程序的某种设备的特征和行为。

例如，生成器可以为连接的风扇创建具有以下特征的设备模板：

- 发送温度遥测
- 发送位置属性
- 发送风扇马达错误事件
- 发送风扇操作状态
- 可写风扇速度属性
- 用于重新启动设备的命令
- 显示设备全方位视图的仪表板

在此设备模板中，操作员可以创建和连接实风扇设备。 所有这些风扇都具有测量、属性和命令，操作员用它们来监视和管理。 操作员使用设备仪表板和窗体与风扇设备交互。

> [!NOTE]
> 只有构建人员和管理员可以创建、编辑和删除设备模板。 任何用户都可以通过现有设备模板在 "**设备**" 页上创建设备。

IoT Central 可以通过 [IoT 即插即用](../../iot-pnp/overview-iot-plug-and-play.md)来集成设备，不需你编写任何嵌入式设备代码。 IoT 即插即用的核心是描述设备功能的设备功能模型架构。 在 IoT Central 预览版应用程序中，设备模板使用这些 IoT 即插即用设备功能模型。

作为构建者，你在创建设备模板时有多种选择：

- 在 IoT Central 中设计设备模板，然后在设备代码中实现其设备功能模型。
- 从 [Azure IoT 认证设备目录](https://aka.ms/iotdevcat)导入设备功能模型，然后添加 IoT Central 应用程序所需的任何云属性、自定义和仪表板。
- 使用 Visual Studio Code 创建设备功能模型。 基于模型实现设备代码。 将设备功能模型手动导入 IoT Central 应用程序，然后添加 IoT Central 应用程序所需的任何云属性、自定义和仪表板。
- 使用 Visual Studio Code 创建设备功能模型。 实现模型中的设备代码，并使用设备首次连接将实际设备连接到 IoT Central 应用程序。 IoT Central 从公共存储库中查找和导入设备功能模型。 然后，你可以将 IoT Central 应用程序所需的任何云属性、自定义和仪表板添加到设备模板中。

## <a name="create-a-device-template-from-the-device-catalog"></a>从设备目录创建设备模板

作为生成器，可以快速开始使用[Azure Iot 设备目录](https://catalog.azureiotsolutions.com/alldevices)中列出的 IoT 即插即用认证设备生成解决方案。 IoT Central 与设备目录集成，使你可以从这些 IoT 即插即用认证设备导入设备功能模型。 若要在 IoT Central 中通过以下设备之一创建设备模板：

1. 在 IoT Central 应用程序中转到 "**设备模板**" 页。
1. 选择 " **+ 新建**"，然后从下面列出的目录中选择任何 IoT 即插即用认证设备。 IoT Central 基于此设备功能模型创建设备模板。
1. 向设备模板添加任何云属性、自定义或视图。
1. 选择 "**发布**" 以发布此设备模板，使其可供操作员查看和连接设备。

## <a name="create-a-device-template-from-scratch"></a>从头开始创建设备模板

设备模板包含：

- 一种_设备功能模型_，指定设备实现的遥测、属性和命令。 这些功能被组织成一个或多个接口。
- 定义 IoT Central 应用程序存储的有关设备信息的_云属性_。 例如，云属性可以记录设备上次服务的数据。 此信息永远不会与设备共享。
- _自定义_使生成器可以覆盖设备功能模型中的一些定义。 例如，生成器可能会重写设备属性的名称。 属性名称显示在 "仪表板" 和 "窗体" IoT Central 中。
- _仪表板和窗体_允许生成器创建一个 UI，该 UI 允许操作员监视和管理连接到应用程序的设备。

在 IoT Central 中创建设备模板：

1. 在 IoT Central 应用程序中转到 "**设备模板**" 页。
1. 选择 " **+ 新建**"，然后选择 "**自定义**"。
1. 输入模板的名称，如 "**环境传感器**"。
1. 按 **Enter**。 IoT Central 创建一个空的设备模板。

## <a name="manage-a-device-template"></a>管理设备模板

可以在模板的主页中重命名或删除模板。

向模板添加设备功能模型后，可以将其发布。 只有在发布模板之后，才能将基于此模板的设备连接到 "**设备**" 页。

## <a name="create-a-capability-model"></a>创建功能模型

若要创建设备功能模型，可以执行以下操作：

- 使用 IoT Central 从头开始创建自定义模型。
- 导入 JSON 文件中的模型。 设备生成器可能已使用 Visual Studio Code 创作应用程序的设备功能模型。
- 从设备目录中选择一台设备。 此选项将导入制造商为此设备发布的设备功能模型。 像这样导入的设备功能模型会自动发布。

## <a name="manage-a-capability-model"></a>管理功能模型

创建设备功能模型后，可以：

- 将接口添加到模型。 模型必须至少有一个接口。
- 编辑模型元数据，如其 ID、命名空间和名称。
- 删除模型。

## <a name="create-an-interface"></a>创建接口

设备功能必须至少具有一个接口。 接口是一种可重用的功能集合。

创建接口：

1. 中转到你的设备功能模型，然后选择 " **+ 添加接口**"。

1. 在 "**选择接口**" 页上，你可以：

    - 从头开始创建自定义接口。
    - 从文件中导入现有接口。 设备生成器可能已使用 Visual Studio Code 为设备创建接口。
    - 选择某个标准接口，如**设备信息**接口。 标准接口指定对许多设备通用的功能。 这些标准接口由 Microsoft Azure IoT 发布，不能进行版本控制或编辑。

1. 创建接口后，选择 "**编辑标识**" 更改接口的显示名称。

1. 如果选择从头开始创建自定义接口，可以添加设备的功能。 设备功能包括遥测、属性和命令。

### <a name="telemetry"></a>遥测

遥测是从设备发送的值流，通常来自传感器。 例如，传感器可以报告环境温度。

下表显示了遥测功能的配置设置：

| 字段 | 说明 |
| ----- | ----------- |
| 显示名称 | 仪表板和窗体上使用的遥测值的显示名称。 |
| 名称 | 遥测消息中字段的名称。 IoT Central 将从显示名称生成此字段的值，但你可以根据需要选择自己的值。 |
| 功能类型 | 清单. |
| 语义类型 | 遥测的语义类型，如温度、状态或事件。 选择的语义类型确定以下哪些字段可用。 |
| 架构 | 遥测数据类型，如 double、string 或 vector。 可用的选项取决于语义类型。 架构不可用于事件和状态语义类型。 |
| 严重性 | 仅适用于事件语义类型。 **错误**、**信息**或**警告**。 |
| 状态值 | 仅适用于状态语义类型。 定义可能的状态值，其中每个值都具有显示名称、名称、枚举类型和值。 |
| 计价单位 | 遥测值的单位，例如**mph**、 **%** 或 **&deg;C**。 |
| 显示单位 | 仪表板和窗体上使用的显示单位。 |
| 注释 | 有关遥测功能的任何注释。 |
| 说明 | 遥测功能的说明。 |

### <a name="properties"></a>属性

属性表示时间点值。 例如，设备可以使用属性来报告尝试访问的目标温度。 可以从 IoT Central 设置可写属性。

下表显示了属性功能的配置设置：

| 字段 | 说明 |
| ----- | ----------- |
| 显示名称 | 仪表板和窗体上使用的属性值的显示名称。 |
| 名称 | 属性的名称。 IoT Central 将从显示名称生成此字段的值，但你可以根据需要选择自己的值。 |
| 功能类型 | 知识产权. |
| 语义类型 | 属性的语义类型，如温度、状态或事件。 选择的语义类型确定以下哪些字段可用。 |
| 架构 | 属性数据类型，如 double、string 或 vector。 可用的选项取决于语义类型。 架构不可用于事件和状态语义类型。 |
| 可 | 如果该属性不是可写的，则设备可以将属性值报告为 IoT Central。 如果该属性是可写的，则设备可以将属性值报告为 IoT Central，IoT Central 可以将属性更新发送到设备。
| 严重性 | 仅适用于事件语义类型。 **错误**、**信息**或**警告**。 |
| 状态值 | 仅适用于状态语义类型。 定义可能的状态值，其中每个值都具有显示名称、名称、枚举类型和值。 |
| 计价单位 | 属性值的单位，例如**mph**、 **%** 或 **&deg;C**。 |
| 显示单位 | 仪表板和窗体上使用的显示单位。 |
| 注释 | 有关属性功能的任何注释。 |
| 说明 | 属性功能的说明。 |

### <a name="commands"></a>命令

可以从 IoT Central 调用设备命令。 命令可以选择将参数传递到设备并接收来自设备的响应。 例如，你可以在10秒内调用命令来重新启动设备。

下表显示了命令功能的配置设置：

| 字段 | 说明 |
| ----- | ----------- |
| 显示名称 | 仪表板和窗体上使用的命令的显示名称。 |
| 名称 | 命令的名称。 IoT Central 将从显示名称生成此字段的值，但你可以根据需要选择自己的值。 |
| 功能类型 | 命令 |
| 命令 | SynchronousExecutionType. |
| 注释 | 有关命令功能的任何注释。 |
| 说明 | 命令功能的说明。 |
| 请求 | 如果启用，则为包含： name、display name、schema、unit 和 display unit 的请求参数的定义。 |
| 响应 | 如果启用，则为命令响应的定义，其中包括：名称、显示名称、架构、单元和显示单位。 |

## <a name="manage-an-interface"></a>管理接口

如果尚未发布接口，则可以编辑该接口定义的功能。 接口发布后，你将需要创建新版本的设备模板，并使接口版本设置为进行任何更改。 不需要版本控制的更改（如显示名称或单元）可以在 "**自定义**" 部分中进行。

如果要在另一个功能模型中重复使用该接口，还可以将其导出为 JSON 文件。

## <a name="add-cloud-properties"></a>添加云属性

使用云属性在 IoT Central 中存储有关设备的信息。 云属性永远不会发送到设备。 例如，你可以使用云属性来存储安装了设备的客户的名称或设备的上一个服务日期。

下表显示了云属性的配置设置：

| 字段 | 说明 |
| ----- | ----------- |
| 显示名称 | 仪表板和窗体上使用的云属性值的显示名称。 |
| 名称 | 云属性的名称。 IoT Central 将从显示名称生成此字段的值，但你可以根据需要选择自己的值。 |
| 语义类型 | 属性的语义类型，如温度、状态或事件。 选择的语义类型确定以下哪些字段可用。 |
| 架构 | 云属性数据类型，如 double、string 或 vector。 可用的选项取决于语义类型。 |

## <a name="add-customizations"></a>添加自定义项

当你需要修改导入的接口或将 IoT Central 特定功能添加到功能时，可以使用自定义。 只能自定义不会破坏接口兼容性的字段。 例如，可以：

- 自定义功能的显示名称和单位。
- 添加在图表上显示值时要使用的默认颜色。
- 指定属性的初始值、最小值和最大值。

无法自定义功能名称或功能类型。 如果在 "**自定义**" 部分中无法进行更改，则需要对设备模板和接口进行版本修改才能修改功能。

### <a name="generate-default-views"></a>生成默认视图

生成默认视图是开始可视化重要设备信息的快捷方法。 最多可为设备模板生成三个默认视图：

1. **命令**将提供一个包含设备命令的视图，并允许操作员将其调度到你的设备。
1. **概述**将提供具有设备遥测的视图，并显示图表和指标。
1. **关于**将提供包含设备信息的视图，并显示设备属性。

选择 "**生成默认视图**" 后，你将看到它们已自动添加到设备模板的 "**视图**" 部分下。

## <a name="add-dashboards"></a>添加仪表板

将仪表板添加到设备模板，使操作员能够使用图表和指标来可视化设备。 一个设备模板可以有多个仪表板。

若要将仪表板添加到设备模板：

1. 请访问你的设备模板并选择 "**视图**"。
1. 然后选择 **"可视化设备"** 。
1. 在 "**仪表板名称**" 中输入仪表板的名称。
1. 从静态、属性、云属性、遥测和命令磁贴的列表中将磁贴添加到仪表板。 拖放要添加到仪表板的磁贴。
1. 若要在单个图表磁贴上绘制多个遥测值，请选择遥测值，然后选择 "**合并**"。
1. 配置添加的每个磁贴，以自定义其显示数据的方式，方法是选择齿轮图标或选择图表磁贴上的 "**更改配置**" 按钮。
1. 排列仪表板上的磁贴并调整其大小。
1. 保存更改。

### <a name="configure-preview-device-to-view-dashboard"></a>配置预览设备以查看仪表板

若要查看和测试您的仪表板，可以选择 "**配置预览版设备**"，它可让您查看仪表板，因为操作员在发布后可以看到它。 此选项允许您验证您的视图是否显示正确的数据。 你可以从任何预览设备中进行选择，也可以从你为设备模板配置的实际测试设备或应用程序中的现有设备中进行选择，方法是使用设备 ID。

## <a name="add-forms"></a>添加窗体

通过查看和设置属性，将窗体添加到设备模板，使操作员可以管理设备。 操作员只能编辑云属性和可写设备属性。 设备模板可以有多种形式。

若要将窗体添加到设备模板：

1. 请访问你的设备模板并选择 "**视图**"。
1. 然后选择 "**编辑设备和云数据**"。
1. 在 "**窗体名称**" 中输入窗体的名称。
1. 选择要用于布局窗体的列数。
1. 将属性添加到窗体上的现有节，或选择 "属性"，然后选择 "**添加节**"。 使用节对窗体上的属性进行分组。 您可以向节中添加标题。
1. 配置窗体上的每个属性以自定义其行为。
1. 排列窗体上的属性。
1. 保存更改。

## <a name="publish-a-device-template"></a>发布设备模板

在可以连接实现设备功能模型的设备之前，必须发布设备模板。

发布设备模板后，只能对设备功能模型进行有限的更改。 若要修改接口，需要[创建并发布新版本](./howto-version-device-template.md)。

若要发布设备模板，请前往设备模板，然后选择 "**发布**"。

发布设备模板后，操作员可以在 "**设备**" 页上添加使用设备模板的实际设备或模拟设备。 但在进行更改时，你可以继续修改并保存设备模板，但是，如果你想要将这些更改推送到操作员以在 "**设备**" 页下查看，则必须选择 "每次**发布**"。

## <a name="next-steps"></a>后续步骤

了解如何在 Azure IoT Central 应用程序中使用设备模板后，你可以：

> [!div class="nextstepaction"]
> [创建新的设备模板版本](howto-version-device-template.md)
> [将 MXChip IoT DevKit 设备连接到 Azure IoT Central 应用程序](howto-connect-devkit.md)
