---
title: Plan reports & monitoring deployment - Azure AD
description: Describes how to plan and execute implmentation of reporting and monitoring.
services: active-directory
author: BarbaraSelden
manager: daveba
ms.service: active-directory
ms.topic: conceptual
ms.workload: identity
ms.subservice: report-monitor
ms.date: 11/13/2018
ms.author: baselden
ms.reviewer: plenzke
ms.collection: M365-identity-device-management
ms.openlocfilehash: 5ad84b8910e8d4f8af9845c33c22d128e317dedc
ms.sourcegitcommit: d6b68b907e5158b451239e4c09bb55eccb5fef89
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/20/2019
ms.locfileid: "74232108"
---
# <a name="plan-an-azure-active-directory-reporting-and-monitoring-deployment"></a>Plan an Azure Active Directory reporting and monitoring deployment

Your Azure Active Directory (Azure AD) reporting and monitoring solution depends on your legal, security, and operational requirements and your existing environment and processes. This article presents the various design options and guides you to the right deployment strategy.

### <a name="benefits-of-azure-ad-reporting-and-monitoring"></a>Benefits of Azure AD reporting and monitoring

Azure AD reporting provides a comprehensive view and logs of Azure AD activity in your environment, including sign in events, audit events, and changes to your directory.

可以将提供的数据用于：

* determine how your apps and services are used.

* detect potential risks affecting the health of your environment.

* troubleshoot issues preventing your users from getting their work done.

* gain insights by seeing audit events of changes to your Azure AD directory.

> [!IMPORTANT]
> Azure AD monitoring enables you to route your logs generated by Azure AD reporting to different target systems. 然后，可以将其保存以供长期使用，或者将其与第三方安全信息和事件管理 (SIEM) 工具集成，以便获取有关环境的见解。

With Azure AD monitoring, you can route logs to:

* an Azure storage account for archival purposes.
* Azure Monitor logs, formerly known as Azure Log Analytics workspace, where you can analyze the data, create dashboards, and alert on specific events.
* an Azure event hub where you can integrate with your existing SIEM tools such as Splunk, Sumologic, or QRadar.

> [!NOTE]
We recently started using the term Azure Monitor logs instead of Log Analytics. 日志数据仍然存储在 Log Analytics 工作区中，并仍然由同一 Log Analytics 服务收集并分析。 我们正在更新术语，以便更好地反映 [Azure Monitor 中的日志](https://docs.microsoft.com/azure/azure-monitor/platform/data-collection)的角色。 有关详细信息，请参阅 [Azure Monitor 术语更改](https://docs.microsoft.com/azure/azure-monitor/azure-monitor-rebrand)。

[Learn more about report retention policies](https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-reports-data-retention).

### <a name="licensing-and-prerequisites-for-azure-ad-reporting-and-monitoring"></a>Licensing and prerequisites for Azure AD reporting and monitoring

You'll need an Azure AD premium license to access the Azure AD sign in logs.

For detailed feature and licensing information in the [Azure Active Directory pricing guide](https://azure.microsoft.com/pricing/details/active-directory/).

To deploy Azure AD monitoring and reporting you'll need a user who is a global administrator or security administrator for the Azure AD tenant.

Depending on the final destination of your log data, you'll need one of the following:

* An Azure storage account that you have ListKeys permissions for. 建议使用常规存储帐户而非 Blob 存储帐户。 有关存储定价信息，请查看 [Azure 存储定价计算器](https://azure.microsoft.com/pricing/calculator/?service=storage)。

* An Azure Event Hubs namespace to integrate with third-party SIEM solutions.

* 用于将日志发送到 Azure Monitor 日志的 Azure Log Analytics 工作区。

## <a name="plan-an-azure-reporting-and-monitoring-deployment-project"></a>Plan an Azure reporting and monitoring deployment project

In this project, you'll define the audiences that will consume and monitor reports, and define your Azure AD monitoring architecture.

### <a name="engage-the-right-stakeholders"></a>Engage the right stakeholders

When technology projects fail, they typically do so due to mismatched expectations on impact, outcomes, and responsibilities. To avoid these pitfalls, [ensure that you're engaging the right stakeholders](https://aka.ms/deploymentplans). Also ensure that stakeholder roles in the project are well understood by documenting the stakeholders and their project input and accountabilities.

### <a name="plan-communications"></a>规划沟通

Communication is critical to the success of any new service. Proactively communicate with your users how their experience will change, when it will change, and how to gain support if they experience issues.

### <a name="document-your-current-infrastructure-and-policies"></a>Document your current infrastructure and policies

Your current infrastructure and policies will drive your reporting and monitoring design. Ensure that you know

* What, if any, SIEM tools you're using.

* Your Azure infrastructure, including existing storage accounts and monitoring being used.

* Your organizational retention policies for logs, including any applicable compliance frameworks required. 

## <a name="plan-an-azure-ad-reporting-and-monitoring-deployment"></a>Plan an Azure AD reporting and monitoring deployment

Reporting and monitoring are used to meet your business requirements, gain insights into usage patterns, and t increase your organizations security posture.

### <a name="business-use-cases"></a>Business use cases

* Required for solution to meet business needs
* Nice to have to meet business needs
* 不适用

|区域 |描述 |
|-|-|
|保留期| **Log retention of more than 30 days**. ‎Due to legal or business requirements it is required to store audit logs and sign in logs of Azure AD longer than 30 days. |
|分析| **The logs need to be searchable**. ‎The stored logs need to be searchable with analytic tools. |
| 操作见解| **Insights for various teams**. The need to give access for different users to gain operational insights such as application usage, sign in errors, self-service usage, trends, etc. |
| Security Insights| **Insights for various teams**. The need to give access for different users to gain operational insights such as application usage, sign in errors, self service usage, trends, etc. |
| Integration in SIEM systems      | **SIEM integration**. ‎The need to integrate and stream Azure AD sign in logs and audit logs to existing SIEM systems. |

### <a name="choose-a-monitoring-solution-architecture"></a>Choose a monitoring solution architecture

With Azure AD monitoring, you can route your Azure AD activity logs to a system that best meets your business needs. You can then retain them for long-term reporting and analysis to gain insights into your environment, and integrate it with SIEM tools.

#### <a name="decision-flow-chartan-image-showing-what-is-described-in-subsequent-sectionsmediareporting-deployment-plandeploy-reporting-flow-diagrampng"></a>Decision flow chart![An image showing what is described in subsequent sections](media/reporting-deployment-plan/deploy-reporting-flow-diagram.png)

#### <a name="archive-logs-in-a-storage-account"></a>Archive logs in a storage account

By routing logs to an Azure storage account, you can keep them for longer than the default retention period outlined in our [retention policies](https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-reports-data-retention). Use this method if you need to archive your logs, but don't need to integrate them with an SIEM system, and don't need ongoing queries and analysis. You can still do on-demand searches.

了解如何[将数据路由到存储帐户](https://docs.microsoft.com/azure/active-directory/reports-monitoring/quickstart-azure-monitor-route-logs-to-storage-account)。

#### <a name="send-logs-to-azure-monitor-logs"></a>将日志发送到 Azure Monitor 日志

[Azure Monitor logs](https://docs.microsoft.com/azure/log-analytics/log-analytics-overview) consolidate monitoring data from different sources. It also provides a query language and analytics engine that gives you insights into the operation of your applications and use of resources. By sending Azure AD activity logs to Azure Monitor logs, you can quickly retrieve, monitor, and alert on collected data. Use this method when you don't have an existing SIEM solution that you want to send your data to directly but do want queries and analysis. Once your data is in Azure Monitor logs, you can then send it to event hub and from there to a SIEM if you want to.

了解如何[将数据发送到 Azure Monitor 日志](https://docs.microsoft.com/azure/active-directory/reports-monitoring/howto-integrate-activity-logs-with-log-analytics)。

You can also install the pre-built views for Azure AD activity logs to monitor common scenarios involving sign in and audit events.

了解如何[安装和使用 Azure AD 活动日志的日志分析视图](https://docs.microsoft.com/azure/active-directory/reports-monitoring/howto-install-use-log-analytics-views)。

#### <a name="stream-logs-to-your-azure-event-hub"></a>Stream logs to your Azure event hub

Routing logs to an Azure event hub enables integration with third-party SIEM tools. 可以通过此集成将 Azure AD 活动日志数据与其他由 SIEM 托管的数据组合起来，获取更丰富的有关环境的见解。 

了解如何[将日志流式传输到事件中心](https://docs.microsoft.com//azure/active-directory/reports-monitoring/tutorial-azure-monitor-stream-logs-to-event-hub)。

## <a name="plan-operations-and-security-for-azure-ad-reporting-and-monitoring"></a>Plan Operations and Security for Azure AD reporting and monitoring

Stakeholders need to access Azure AD logs to gain operational insights. Likely users include security team members, internal or external auditors, and the identity and access management operations team.

Azure AD roles enable you to delegate the ability to configure and view Azure AD Reports based on your role. Identify who in your organization needs permission to read Azure AD reports and what role would be appropriate for them. 

The following roles can read Azure AD reports:

* 全局管理员

* 安全管理员

* 安全读取者

* Report Reader

Learn More About [Azure AD Administrative Roles](https://docs.microsoft.com/azure/active-directory/active-directory-assign-admin-roles-azure-portal).

*Always apply the concept of least privileges to reduce the risk of an account compromise*. Consider implementing [Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure) to further secure your organization.

##  

## <a name="deploy-azure-ad-reporting-and-monitoring"></a>Deploy Azure AD reporting and monitoring

Depending on the decisions you have made earlier using the design guidance above, this section will guide you to the documentation on the different deployment options.

### <a name="consume-and-archive-azure-ad-logs"></a>Consume and archive Azure AD logs

[在 Azure 门户中查找活动报告](https://docs.microsoft.com/azure/active-directory/reports-monitoring/howto-find-activity-reports)

[Archive Azure AD logs to an Azure Storage account](https://docs.microsoft.com/azure/active-directory/reports-monitoring/quickstart-azure-monitor-route-logs-to-storage-account)

### <a name="implement-monitoring-and-analytics"></a>Implement monitoring and analytics

[Send logs to Azure Monitor](https://docs.microsoft.com/azure/active-directory/reports-monitoring/howto-integrate-activity-logs-with-log-analytics)

[安装和使用用于 Azure Active Directory 的日志分析视图](https://docs.microsoft.com/azure/active-directory/reports-monitoring/howto-install-use-log-analytics-views)

[使用 Azure Monitor 日志分析 Azure AD 活动日志](https://docs.microsoft.com/azure/active-directory/reports-monitoring/howto-analyze-activity-logs-log-analytics)

* [解释 Azure Monitor 中的审核日志架构](https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-azure-monitor-audit-log-schema)

* [Interpret sign in logs schema in Azure Monitor](https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-azure-monitor-sign-ins-log-schema)

 * [Stream Azure AD logs to an Azure event hub](https://docs.microsoft.com/azure/active-directory/reports-monitoring/tutorial-azure-monitor-stream-logs-to-event-hub)

* [使用 Azure Monitor 将 Azure AD 日志与 Splunk 集成](https://docs.microsoft.com/azure/active-directory/reports-monitoring/tutorial-integrate-activity-logs-with-splunk)

* [使用 Azure Monitor 将 Azure AD 日志与 SumoLogic 集成](https://docs.microsoft.com/azure/active-directory/reports-monitoring/howto-integrate-activity-logs-with-sumologic)

 

 

## <a name="next-steps"></a>后续步骤

Consider implementing [Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure) 

Consider implementing [Role-based access control (RBAC)](https://docs.microsoft.com/azure/role-based-access-control/overview)

 
