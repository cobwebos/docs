---
title: "用于 B2B 企业集成的 EDIFACT 消息 - Azure 逻辑应用 | Microsoft 文档"
description: "使用 Azure 逻辑应用交换 EDI 格式的 EDIFACT 消息以实现 B2B 企业集成"
services: logic-apps
documentationcenter: .net,nodejs,java
author: jeffhollan
manager: anneta
editor: 
ms.assetid: 2257d2c8-1929-4390-b22c-f96ca8b291bc
ms.service: logic-apps
ms.workload: integration
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.custom: H1Hack27Feb2017
ms.date: 07/26/2016
ms.author: LADocs; jonfan
ms.openlocfilehash: fc9a0068de5f9464133eec0b043fbba1dc0fbde7
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/11/2017
---
# <a name="exchange-edifact-messages-for-enterprise-integration-with-logic-apps"></a>使用逻辑应用交换 EDIFACT 消息以实现企业集成

在交换 Azure 逻辑应用的 EDIFACT 消息之前，必须先创建 EDIFACT 协议并将它存储在集成帐户中。 下面是创建 EDIFACT 协议的步骤。

> [!NOTE]
> 本页介绍 Azure 逻辑应用的 EDIFACT 功能。 有关详细信息，请参阅 [X12](logic-apps-enterprise-integration-x12.md)。

## <a name="before-you-start"></a>开始之前

下面是需要准备好的项：

* 已定义的、与 Azure 订阅关联的[集成帐户](../logic-apps/logic-apps-enterprise-integration-accounts.md)  
* 已在集成帐户中至少定义了两个[合作伙伴](logic-apps-enterprise-integration-partners.md)

> [!NOTE]
> 创建协议时，与合作伙伴之间相互接收或发送的消息中的内容必须与协议类型匹配。

[创建集成帐户](../logic-apps/logic-apps-enterprise-integration-accounts.md)并[添加合作伙伴](logic-apps-enterprise-integration-partners.md)之后，可以遵循以下步骤来创建 EDIFACT 协议。

## <a name="create-an-edifact-agreement"></a>创建 EDIFACT 协议 

1.  登录 [Azure 门户](http://portal.azure.com "Azure portal")。 在左侧菜单中，选择“更多服务”。

    > [!TIP]
    > 如果未看到“更多服务”，可能需要先展开菜单。 在折叠的菜单顶部，选择“显示菜单”。

    ![在左侧菜单中，选择“更多服务”](./media/logic-apps-enterprise-integration-edifact/edifact-0.png)

2. 在搜索框中，为筛选器键入“集成”。 在结果列表中，选择“集成帐户”。

    ![筛选“集成”，选择“集成帐户”](./media/logic-apps-enterprise-integration-edifact/edifact-1-3.png)

3. 在打开的“集成帐户”边栏选项卡中，选择要在其中创建协议的集成帐户。
如果未看到任何集成帐户，请[先创建一个集成帐户](../logic-apps/logic-apps-enterprise-integration-accounts.md "有关集成帐户的详细信息")。  

    ![选择要在其中创建协议的集成帐户](./media/logic-apps-enterprise-integration-edifact/edifact-1-4.png)

4. 选择“协议”磁贴。 如果未添加“协议”磁贴，请先添加该磁贴。   

    ![选择“协议”磁贴](./media/logic-apps-enterprise-integration-edifact/edifact-1-5.png)

5. 在打开的“协议”边栏选项卡中，选择“添加”。

    ![选择“添加”](./media/logic-apps-enterprise-integration-edifact/edifact-agreement-2.png)

6. 在“添加”下面，输入协议的**名称**。 对于“协议类型”，请选择“EDIFACT”。 为协议选择“宿主合作伙伴”，“宿主标识”、“来宾合作伙伴”和“来宾标识”。

    ![提供协议详细信息](./media/logic-apps-enterprise-integration-edifact/edifact-1.png)

    | 属性 | 说明 |
    | --- | --- |
    | Name |协议的名称 |
    | 协议类型 | 应为 EDIFACT |
    | 管理方 |协议需要有管理方和托管方。 宿主合作伙伴代表配置协议的组织。 |
    | 管理方标识 |管理方的标识符 |
    | 托管方 |协议需要有管理方和托管方。 托管方代表与管理方进行交易的组织。 |
    | 托管方标识 |托管方的标识符 |
    | 接收设置 |这些属性适用于协议接收的所有消息。 |
    | 发送设置 |这些属性适用于协议发送的所有消息。 |

## <a name="configure-how-your-agreement-handles-received-messages"></a>配置协议如何处理收到的消息

设置协议属性后，可以配置此协议如何识别和处理从合作伙伴接收的传入消息。

1.  在“添加”下面，选择“接收设置”。
根据要与其交换消息的合作伙伴达成的协议来配置这些属性。 有关属性说明，请参阅本部分中的表格。

    “接收设置”划分为以下部分：“标识符”、“确认”、“架构”、“控制编号”、“验证”和“内部设置”。

    ![配置“接收设置”](./media/logic-apps-enterprise-integration-edifact/edifact-2.png)  

2. 完成后，请务必选择“确定”保存设置。

协议现已准备就绪，可以处理符合所选设置的传入消息。

### <a name="identifiers"></a>标识符

| 属性 | 说明 |
| --- | --- |
| UNB6.1 (收件人引用密码) |输入范围在 1 到 14 个字符之间的字母数字值。 |
| UNB6.2 (收件人引用限定符) |输入包含最少一个字符且最多二个字符的字母数字值。 |

### <a name="acknowledgments"></a>致谢

| 属性 | 说明 |
| --- | --- |
| 接收消息(CONTRL) |选中此复选框可向交换发送方返回技术 (CONTRL) 确认。 该确认会基于协议的“发送设置”发送给交换发送方。 |
| 确认(CONTRL) |选中此复选框可向交换发送方返回功能 (CONTRL) 确认。该确认会基于协议的“发送设置”发送给交换发送方。 |

### <a name="schemas"></a>架构

| 属性 | 说明 |
| --- | --- |
| UNH2.1 (类型) |选择事务集类型。 |
| UNH2.2 (版本) |输入消息版本号。 （最少一个字符；最多三个字符）。 |
| UNH2.3 (发布) |输入消息发布号。 （最少一个字符；最多三个字符）。 |
| UNH2.5 (协会分配的代码) |输入分配的代码。 （最多六个字符。 必须是字母数字）。 |
| UNG2.1 (应用发送方 ID) |输入包含最少一个字符且最多 35 个字符的字母数字值。 |
| UNG2.2 (应用发送方代码限定符) |输入包含最多四个字符的字母数字值。 |
| 架构 |从关联的集成帐户中选择要使用的以前上传的架构。 |

### <a name="control-numbers"></a>控制编号
| 属性 | 说明 |
| --- | --- |
| 不允许交换控制编号重复项 |若要阻止重复交换，请选择此属性。 如果选中，则 EDIFACT 解码操作会检查收到的交换的交换控制编号 (UNB5) 是否与以前处理的交换控制编号不匹配。 如果检测到匹配项，则不处理交换。 |
| 检查重复的 UNB5 的时间间隔为每(天) |如果选择禁止重复的交换控制编号，可以通过为此设置提供适当的值，来指定执行检查的间隔天数。 |
| 不允许组合控制编号重复项 |若要阻止具有重复组控制编号 (UNG5) 的交换，请选择此属性。 |
| 不允许事务集控制编号重复项 |若要阻止具有重复事务集控制编号 (UNH1) 的交换，请选择此属性。 |
| EDIFACT 确认控制编号 |若要指定要在确认中使用的事务集引用编号，请为前缀、引用编号的范围和后缀输入值。 |

### <a name="validations"></a>验证

完成每个验证行后，会自动添加另一行。 如果未指定任何规则，验证将使用“默认”行。

| 属性 | 说明 |
| --- | --- |
| 消息类型 |选择 EDI 消息类型。 |
| EDI 验证 |根据架构的 EDI 属性、长度限制、空数据元素和尾部分隔符的定义，对数据类型执行 EDI 验证。 |
| 扩展验证 |如果数据类型不是 EDI，则验证会基于数据元素要求，以及允许重复、枚举和数据元素长度验证（最小/最大）。 |
| 允许前导零/尾随零 |保留所有前导或尾随零和空格字符。 不要删除这些字符。 |
| 剪裁前导零/尾随零 |删除前导或尾随零和空格字符。 |
| 尾部分隔符策略 |生成尾部分隔符。 <p>选择“不允许”会禁止在接收的交换中包含尾部分隔符。 如果交换包含尾部分隔符，会将它声明为无效。 <p>选择“可选”可接受包含或不包含尾部分隔符的交换。 <p>如果接收的交换必须包含尾部分隔符，请选择“强制”。 |

### <a name="internal-settings"></a>内部设置

| 属性 | 说明 |
| --- | --- |
| 如果允许尾随分隔符，请创建空的 XML 标记 |选中此复选框可使交换发送方包含用于尾随分隔符的空 XML 标记。 |
| 将交换拆分为事务集 - 出错时暂停事务集|通过将相应信封应用于事务集，将交换中的每个事务集分析为单独 XML 文档。 仅暂停未通过验证的事务集。 |
| 将交换拆分为事务集 - 出错时暂停交换|通过应用相应信封，将交换中的每个事务集分析为单独 XML 文档。 如果交换中的一个或多个事务集未能通过验证，则暂停整个交换。 | 
| 保留交换 - 出错时暂停事务集 |保留交换不变，为整个批处理交换创建 XML 文档。 仅暂停未能通过验证的事务集，同时继续处理所有其他事务集。 |
| 保留交换 - 出错时暂停交换 |保留交换不变，为整个批处理交换创建 XML 文档。 如果交换中的一个或多个事务集未能通过验证，则暂停整个交换。 |

## <a name="configure-how-your-agreement-sends-messages"></a>配置协议如何发送消息

可以配置此协议如何识别和处理发送给合作伙伴的传出消息。

1.  在“添加”下面，选择“发送设置”。
根据要与其交换消息的合作伙伴达成的协议来配置这些属性。 有关属性说明，请参阅本部分中的表格。

    “发送设置”划分为以下部分：“标识符”、“确认”、“架构”、“字符集和分隔符”、“控制编号”和“验证”。

    ![配置“发送设置”](./media/logic-apps-enterprise-integration-edifact/edifact-3.png)    

2. 完成后，请务必选择“确定”保存设置。

协议现已准备就绪，可以处理符合所选设置的传出消息。

### <a name="identifiers"></a>标识符

| 属性 | 说明 |
| --- | --- |
| UNB1.2 (语法版本) |选择介于 **1** 和 **4** 之间的值。 |
| UNB2.3 (发件人反向路由地址) |输入包含最少一个字符且最多 14 个字符的字母数字值。 |
| UNB3.3 (收件人反向路由地址) |输入包含最少一个字符且最多 14 个字符的字母数字值。 |
| UNB6.1 (收件人引用密码) |输入包含最少一个字符且最多 14 个字符的字母数字值。 |
| UNB6.2 (收件人引用限定符) |输入包含最少一个字符且最多二个字符的字母数字值。 |
| UNB7 (应用程序引用 ID) |输入包含最少一个字符且最多 14 个字符的字母数字值 |

### <a name="acknowledgment"></a>确认
| 属性 | 说明 |
| --- | --- |
| 接收消息(CONTRL) |如果宿主合作伙伴预期收到技术 (CONTRL) 确认，请选中此复选框。 此设置指定发送消息的主机合作伙伴从来宾合作伙伴请求确认。 |
| 确认(CONTRL) |如果主机合作伙伴期望收到功能 (CONTRL) 确认，则选中此复选框。 此设置指定发送消息的主机合作伙伴从来宾合作伙伴请求确认。 |
| 为已接受的事务集生成 SG1/SG4 循环 |如果选择请求功能确认，则选中此复选框可强制为已接受的事务集在功能 CONTRL 确认中生成 SG1/SG4 循环。 |

### <a name="schemas"></a>架构
| 属性 | 说明 |
| --- | --- |
| UNH2.1 (类型) |选择事务集类型。 |
| UNH2.2 (版本) |输入消息版本号。 |
| UNH2.3 (发布) |输入消息发布号。 |
| 架构 |选择要使用的架构。 架构位于集成帐户中。 要访问架构，请先将集成帐户链接到逻辑应用。 |

### <a name="envelopes"></a>信封
| 属性 | 说明 |
| --- | --- |
| UNB8 (Processing Priority Code) |输入长度不超过一个字符的字母数字值。 |
| UNB10 (通信协议) |输入包含最少一个字符且最多 40 个字符的字母数字值。 |
| UNB11 (测试指示器) |选中此复选框可指示生成的交换是测试数据 |
| 应用 UNA 段(服务字符串建议) |选中此复选框可为要发送的交换生成 UNA 段。 |
| 应用 UNG 段(功能组标头) |选中此复选框可在发送给来宾合作伙伴的消息的功能组标头中创建分组段。 以下值用于创建 UNG 段： <p>对于“UNG1”，输入包含最少一个字符且最多六个字符的字母数字值。 <p>对于“UNG2.1”，输入包含最少一个字符且最多 35 个字符的字母数字值。 <p>对于“UNG2.2”，输入包含最多四个字符的字母数字值。 <p>对于“UNG3.1”，输入包含最少一个字符且最多 35 个字符的字母数字值。 <p>对于“UNG3.2”，输入包含最多四个字符的字母数字值。 <p>对于“UNG6”，输入包含最少一个字符且最多三个字符的字母数字值。 <p>对于“UNG7.1”，输入包含最少一个字符且最多三个字符的字母数字值。 <p>对于“UNG7.2”，输入包含最少一个字符且最多三个字符的字母数字值。 <p>对于“UNG7.3”，输入包含最少 1 个字符且最多 6 个字符的字母数字值。 <p>对于“UNG8”，输入包含最少一个字符且最多 14 个字符的字母数字值。 |

### <a name="character-sets-and-separators"></a>字符集和分隔符

除了字符集，可以输入要用于每种消息类型的不同分隔符集。 如果没有为给定消息架构指定字符集，则使用默认字符集。

| 属性 | 说明 |
| --- | --- |
| UNB1.1 (系统标识符) |选择要应用于传出交换的 EDIFACT 字符集。 |
| 架构 |从下拉列表中选择架构。 完成每行后，会自动添加新行。 对于所选的架构，请根据以下分隔符说明选择要使用的分隔符集。 |
| 输入类型 |从下拉列表中选择输入类型。 |
| 组件分隔符 |若要分隔复合数据元素，请输入单个字符。 |
| 数据元素分隔符 |若要分隔复合数据元素中的简单数据元素，请输入单个字符。 |
| 段终止符 |若要指示 EDI 段的结尾，请输入单个字符。 |
| 后缀 |选择与段标识符一起使用的字符。 如果指定了后缀，则段终止符数据元素可以为空。 如果段终止符保留为空，则必须指定后缀。 |

### <a name="control-numbers"></a>控制编号
| 属性 | 说明 |
| --- | --- |
| UNB5 (交换控制编号) |输入前缀、交换控制编号的值范围和后缀。 这些值用于生成传出交换。 前缀和后缀是可选的，而控制编号是必需的。 控制编号对于每个新消息递增；前缀和后缀保持不变。 |
| UNG5 (组控制编号) |输入前缀、交换控制编号的值范围和后缀。 这些值用于生成组控制编号。 前缀和后缀是可选的，而控制编号是必需的。 控制编号对于每个新消息递增，直到达到最大值；前缀和后缀保持不变。 |
| UNH1 (消息标头引用编号) |输入前缀、交换控制编号的值范围和后缀。 这些值用于生成消息标头引用编号。 前缀和后缀是可选的，而引用编号是必需的。 引用编号对于每个新消息递增；前缀和后缀保持不变。 |

### <a name="validations"></a>验证

完成每个验证行后，会自动添加另一行。 如果未指定任何规则，验证将使用“默认”行。

| 属性 | 说明 |
| --- | --- |
| 消息类型 |选择 EDI 消息类型。 |
| EDI 验证 |根据架构的 EDI 属性、长度限制、空数据元素和尾部分隔符的定义，对数据类型执行 EDI 验证。 |
| 扩展验证 |如果数据类型不是 EDI，则验证会基于数据元素要求，以及允许重复、枚举和数据元素长度验证（最小/最大）。 |
| 允许前导零/尾随零 |保留所有前导或尾随零和空格字符。 不要删除这些字符。 |
| 剪裁前导零/尾随零 |删除前导或尾随零字符。 |
| 尾部分隔符策略 |生成尾部分隔符。 <p>选择“不允许”会禁止在发送的交换中包含尾部分隔符。 如果交换包含尾部分隔符，会将它声明为无效。 <p>选择“可选”可发送包含或不包含尾部分隔符的交换。 <p>如果发送的交换必须包含尾部分隔符，请选择“强制”。 |

## <a name="find-your-created-agreement"></a>查找创建的协议

1.  设置完所有协议属性后，请在“添加”边栏选项卡中选择“确定”来完成创建协议，并返回到集成帐户边栏选项卡。

    新添加的协议随即会出现在“协议”列表中。

2.  还可以在集成帐户概述中查看协议。 在集成帐户边栏选项卡中选择“概述”，并选择“协议”磁贴。 

    ![选择“协议”磁贴可查看所有协议](./media/logic-apps-enterprise-integration-edifact/edifact-4.png)   

## <a name="view-swagger-file"></a>查看 Swagger 文件
若要查看 EDIFACT 连接器的 Swagger 详细信息，请参阅 [EDIFACT](/connectors/edifact/)。

## <a name="learn-more"></a>了解详细信息
* [了解有关 Enterprise Integration Pack 的详细信息](logic-apps-enterprise-integration-overview.md "了解 Enterprise Integration Pack")  

