---
title: 功能哈希:模块参考
titleSuffix: Azure Machine Learning service
description: 了解如何使用 Azure 机器学习 service 中的特征哈希模块来对文本数据进行特征。
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: xiaoharper
ms.author: zhanxia
ms.date: 09/01/2019
ms.openlocfilehash: 78d01cf071faed312773ebf12c75e7e6e5596e71
ms.sourcegitcommit: d470d4e295bf29a4acf7836ece2f10dabe8e6db2
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/02/2019
ms.locfileid: "70210840"
---
# <a name="feature-hashing"></a>功能哈希

本文介绍了 Azure 机器学习服务的可视界面 (预览) 的模块。

使用 "**特征哈希**" 模块将英语文本转换为一组整数特征。 然后, 你可以将此哈希功能集传递到机器学习算法, 以训练文本分析模型。

此模块中提供的功能哈希功能基于 nimbusml framework。 有关详细信息, 请参阅[NgramHash 类](https://docs.microsoft.com/python/api/nimbusml/nimbusml.feature_extraction.text.extractor.ngramhash?view=nimbusml-py-latest)。

## <a name="what-is-feature-hashing"></a>什么是功能哈希

功能哈希处理的工作原理是将唯一标记转换为整数。 它对你作为输入提供的确切字符串进行操作, 而不执行任何语言分析或预处理。 

例如, 采用一组简单的句子, 后跟一个情绪分数。 假设您要使用此文本来生成模型。

|USERTEXT|情绪|
|--------------|---------------|
|我喜欢本书|3|
|我痛恨本书|1|
|本书非常好|3|
|我喜欢图书|2|

"**特征哈希**" 模块在内部创建 n 元语法的字典。 例如, 此数据集的二元语法的列表如下所示:

|术语 (二元语法)|率|
|------------|---------------|
|本书|3|
|我喜欢|1|
|我痛恨|1|
|我喜欢|1|

可以使用**n 元语法**来控制 n 元语法的大小。 如果选择二元语法, 则也会计算获得单元语法。 字典还会包含如下所示的单个术语:

|术语 (获得单元语法)|率|
|------------|---------------|
|通讯|3|
|I|3|
|帐簿|1|
|为|1|

生成字典后, "**特征哈希**" 模块将字典字词转换为哈希值。 然后, 它计算每个事例中是否使用了某个功能。 对于每行文本数据, 模块将输出一组列, 每个哈希特征对应一列。

例如, 在进行哈希运算后, 特征列可能如下所示:

|Rating|哈希功能1|哈希功能2|哈希功能3|
|-----|-----|-----|-----|
|4|1|1|0|
|5|0|0|0|

* 如果列中的值为 0, 则该行不包含哈希功能。
* 如果值为 1, 则该行将包含该功能。

利用功能哈希处理, 可将可变长度的文本文档表示为长度相等的数字特征向量, 以实现维数缩减。 如果尝试将文本列用于定型, 则会将其视为具有多个非重复值的分类特征列。

通过数字输出, 还可以使用常见的机器学习方法, 包括分类、群集和信息检索。 因为查找操作可以使用整数哈希而不是字符串比较, 所以, 获取功能权重也要快得多。

## <a name="configure-feature-hashing"></a>配置功能哈希

1.  将**特征哈希**模块添加到视觉对象界面中的试验。

1. 连接包含要分析的文本的数据集。

    > [!TIP]
    > 由于特征哈希不会执行词法运算 (例如词干分析或截断), 因此在应用特征哈希处理之前, 您可以通过执行文本预处理来获得更好的结果。 

1. 将 "**目标列**" 设置为要转换为哈希功能的文本列。 

    * 列必须是字符串数据类型。
    
    * 选择多个文本列会对功能维度产生重大影响。 例如, 对于两个列, 10 位哈希的列数从1024到从到2048的单个列。

1. 使用**哈希 bitsize**指定创建哈希表时要使用的位数。
    
    默认的位大小为10。 对于许多问题, 此值就足够了。 可能需要更多的空间来避免冲突, 具体取决于定型文本 n 元的大小词汇。
    
1. 对于**n 语法**, 请键入一个数字, 该数字定义要添加到定型字典的 N 元语法的最大长度。 N 元语法是由*n*个单词组成的序列, 被视为唯一单元。

    例如, 如果输入 3, 则将创建获得单元语法、二元语法和 trigrams。

1. 运行试验。

## <a name="results"></a>结果

处理完成后, 模块将输出转换后的数据集, 其中, 原始文本列已转换为多个列, 每个列表示文本中的一项功能。 根据字典的重要程度, 生成的数据集可能很大:

|列名1|列类型2|
|-------------------|-------------------|
|USERTEXT|原始数据列|
|情绪|原始数据列|
|USERTEXT 哈希功能1|哈希特征列|
|USERTEXT 哈希功能2|哈希特征列|
|USERTEXT 哈希特征 n|哈希特征列|
|USERTEXT 哈希功能1024|哈希特征列|

在您创建转换后的数据集之后, 您可以将其用作 "定型模型" 模块的输入。
 
### <a name="best-practices"></a>最佳实践

以下最佳实践可帮助你充分利用**功能哈希**模块:

* 在使用 "**特征哈希**" 对输入文本进行预处理之前, 添加 "**预处理文本**" 模块。 

* 在 "**特征哈希**" 模块后面添加 "**选择列**" 模块, 以便从输出数据集中删除文本列。 生成哈希功能后, 不需要文本列。
    
* 请考虑使用这些文本预处理选项, 以简化结果和提高准确性:

    * 断开词语
    * 停止词删除
    * 大小写规范化
    * 删除标点和特殊字符
    * 词干  

适用于任何单独解决方案的一组最佳的预处理方法取决于域、词汇和业务需求。 试验您的数据以查看哪些文本处理方法最有效。

## <a name="next-steps"></a>后续步骤
            
查看可用于 Azure 机器学习服务[的模块集](module-reference.md)。 
