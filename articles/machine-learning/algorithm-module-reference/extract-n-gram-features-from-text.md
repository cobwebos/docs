---
title: 提取 N 语法:模块参考
titleSuffix: Azure Machine Learning service
description: 了解如何使用 Azure 机器学习服务中的 "提取 N 元语法" 模块来对文本数据进行特征。
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: xiaoharper
ms.author: zhanxia
ms.date: 09/01/2019
ms.openlocfilehash: 450c205f92fc65cad4e552aef3a1f28157d25ab6
ms.sourcegitcommit: d470d4e295bf29a4acf7836ece2f10dabe8e6db2
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/02/2019
ms.locfileid: "70210866"
---
# <a name="extract-n-gram-features-from-text"></a>从文本提取 N 元语法特征

本文介绍了 Azure 机器学习服务的可视界面 (预览) 的模块。

使用 "**从文本中提取 N 元语法特征**" 模块到 "*特征*非结构化文本数据"。

此模块支持使用 n 语法字典的下列方案:

* 从任意一列的可用文本[创建新的 n 元语法词典](#create-a-new-n-gram-dictionary)。

* [使用一组现有的文本功能](#use-an-existing-n-gram-dictionary)来为任意文本列设置特征。

* [评分或发布](#score-or-publish-a-model-that-uses-n-grams)使用 n 元语法的模型。

## <a name="configure-extract-n-gram-features-from-text"></a>配置从文本提取 N 元语法特征

### <a name="create-a-new-n-gram-dictionary"></a>创建新的 n 语法语法

1.  将 "**从文本中提取 N 元语法特征**" 模块添加到试验中, 并连接包含要处理的文本的数据集。

1.  使用 "**文本列**" 选择类型为 "**字符串**" 的列, 该列包含要提取的文本。 由于结果是详细的, 因此, 一次只能处理一列。

1. 将 "**词汇模式**" 设置为 "**创建**", 以指示您要创建一个具有 n 元语法功能的新列表。 

1. 设置**n-克大小**以指示要提取和存储的 n 元语法的*最大*大小。 

    例如, 如果输入 3, 则将创建获得单元语法、二元语法和 trigrams。

1. **权重函数**指定如何构建文档功能矢量以及如何从文档中提取词汇。

    * **二元权重**:将二进制状态值分配给提取的 n 语法。 给定文档中的每个 n 语法值都为 1, 否则为0。

    * **TF 权重**:将术语 "频率评分" (**TF**) 分配给提取的 n 元语法。 每个 n 语法的值是在给定文档中的发生频率。

    * **IDF 权重**:将反转文档频率评分 (**IDF**) 分配给提取的 n 元语法。 每个 n 元语法的值是语料库大小的对数除以其在整个语料库中的发生频率。 `IDF = log of corpus_size / document_frequency`
 
    *  **TF-IDF 权重**:将术语 "频率/反转文档频率评分 (**TF/IDF**)" 分配给提取的 n 元语法。 每个 n 元语法的值是其 TF 分数乘以其 IDF 分数。

1. 将**最小字词长度**设置为可以在 n 语法中的任何*单个字词*中使用的最小字母数。

1. 使用**最大字长**时间设置可在 n 语法中的任何*单个字词*中使用的最大字母数。

    默认情况下, 允许每个单词或标记最多包含25个字符。

1. 使用**最少 n 语法文档绝对频率**, 设置要包含在 n 语法字典中的任何 n 元语法所需的最小出现次数。 

    例如, 如果使用默认值 5, 则任何 n 语法都必须在语料库中至少显示5次, 才能包含在 n 语法字典中。 

1.  将**最大 n 语法文档比率**设置为包含特定 n 语法的行数的最大比, 超过总体语料库中的行数。

    例如, 比率为 1, 则表示即使每行中都有特定的 n 元语法, 也可以将 n 语法添加到 n 语法字典中。 通常, 每一行中出现的词都被视为干扰词, 并将被删除。 若要筛选出域相关干扰词, 请尝试降低此比率。

    > [!IMPORTANT]
    > 特定单词的出现频率不一致, 但不同于文档的不同之处。 例如, 如果你要分析有关特定产品的客户评论, 则产品名称可能会非常高且接近干扰词, 但在其他上下文中是一个重要的术语。

1. 选择 "**规范化 n 语法特征向量**" 选项以规范化特征向量。 如果启用, 则每个 n 语法特征矢量除以其 L2 标准。

1. 运行试验。

### <a name="use-an-existing-n-gram-dictionary"></a>使用现有的 n 语法语法字典

1.  将 "**从文本中提取 N 元语法特征**" 模块添加到实验, 并将包含要处理的文本的数据集连接到**数据集**端口。

1.  使用 "**文本列**" 选择包含要进行特征化的文本的文本列。 默认情况下, 该模块选择字符串类型的所有列。 为了获得最佳结果, 请一次处理一列。

1. 添加已保存的数据集, 其中包含之前生成的 n 元语法字典, 并将其连接到**输入词汇**端口。 您还可以将 "**从文本中提取 N 元语法特征" 功能**的输出实例的**结果词汇**输出连接起来。

1. 对于**词汇模式**, 请从下拉列表中选择以下更新选项:

   * **ReadOnly**:表示输入词汇的输入语料库。 输入词汇中的 n 元语法权重将按原样应用, 而不是从新文本数据集中计算字词频率。

    > [!TIP]
    > 评分文本分类器时, 请使用此选项。

1.  对于所有其他选项, 请参阅[上一节](#create-a-new-n-gram-dictionary)中的属性说明。

1.  运行试验。

### <a name="score-or-publish-a-model-that-uses-n-grams"></a>评分或发布使用 n 元语法的模型

1.  将 "**从文本中提取 N 元语法特征" 功能**从定型数据流复制到计分数据流。

1.  将定型数据流的**结果词汇**输出连接到计分数据流上的**输入词汇**。

1.  在 "计分工作流" 中, 修改 "**从文本中提取 N 元语法特征**" 并进行这些更改, 使其他内容保持不变:

    - 将**词汇模式**参数设置为**ReadOnly**。

1.  若要发布试验, 请将**结果词汇**保存为数据集。

1.  然后, 将保存的数据集连接到计分图中的 "**从文本中提取 N 元语法特征**" 模块。

## <a name="results"></a>结果

"**从文本中提取 N 元语法特征**" 模块创建了两种类型的输出: 

* **结果数据集**:经过分析的文本的摘要, 并将其与提取的 n 元语法组合在一起。 未在 "**文本列**" 选项中选择的列将传递到输出。 对于您分析的每个文本列, 该模块将生成以下列:

  * **N 语法匹配项的矩阵**:该模块为 total 语料库中找到的每个 n 语法生成一列, 并在每个列中添加一个分数, 以指示该行的 n 元语法的权重。 

* **结果词汇**:词汇包含实际的 n 元语法字典, 以及作为分析的一部分生成的字词分数。 您可以保存数据集以使用一组不同的输入, 或者用于以后的更新。 还可以重复使用词汇进行建模和评分。

### <a name="result-vocabulary"></a>结果词汇

词汇包含 n 语法字典, 其中包含在分析过程中生成的术语 "频率分数"。 无论其他选项如何, 都将生成评分**DF**和**IDF** 。

+ **ID**：为每个唯一的 n 语法生成的标识符。
+ **NGram**:N 语法。 空格或其他单词分隔符将替换为下划线字符。
+ **DF**:原始语料库中 n 元语法的字词分数。
+ **IDF**:原始语料库中 n 语法的反转文档频率分数。

您可以手动更新此数据集;但是, 你可能会引入错误。 例如：

* 如果模块发现输入词汇中具有相同键的重复行, 则会引发错误。 请确保词汇中没有两行具有相同的单词。
* 词汇数据集的输入架构必须完全匹配, 包括列名和列类型。 
* **ID**列和**DF**计分列必须是整数类型。 
* **IDF**列的类型必须为 FLOAT。

> [!Note]
> 不要直接将数据输出连接到**训练模型**模块。 在将自由文本列送入**定型模型**之前, 应将其删除, 否则, 将会将自由文本列视为分类特征。

## <a name="next-steps"></a>后续步骤

查看可用于 Azure 机器学习服务[的模块集](module-reference.md)。 
